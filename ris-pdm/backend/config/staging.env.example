# Staging Environment Configuration Template
# Copy this file to .env.staging and configure with your staging values

# ================================================================
# SERVER CONFIGURATION
# ================================================================
PORT=3002
NODE_ENV=staging
CORS_ORIGIN=https://staging.your-frontend-domain.com

# Staging security (production-like but with some debug features)
SKIP_AUTH=false
SESSION_SECRET=staging-session-secret-change-for-production
JWT_SECRET=staging-jwt-secret-key

# ================================================================
# AZURE DEVOPS CONFIGURATION
# ================================================================

# Azure DevOps Organization and Project (staging environment)
AZURE_DEVOPS_ORG=your-staging-organization
AZURE_DEVOPS_PROJECT=Your Staging Project

# Staging Authentication (test both PAT and OAuth)
AZURE_DEVOPS_PAT=your-staging-personal-access-token

# OAuth configuration for staging
AZURE_OAUTH_CLIENT_ID=your-staging-azure-ad-app-client-id
AZURE_OAUTH_CLIENT_SECRET=your-staging-azure-ad-app-client-secret
AZURE_OAUTH_REDIRECT_URI=https://staging-api.your-domain.com/auth/azure/callback

# API Configuration
AZURE_DEVOPS_API_VERSION=7.0
AZURE_DEVOPS_RATE_LIMIT=120

# Multi-project support
AZURE_DEVOPS_FETCH_ALL_PROJECTS=true

# ================================================================
# REDIS CONFIGURATION
# ================================================================

# Staging Redis (production-like setup)
REDIS_URL=redis://staging-redis-host:6379
REDIS_PASSWORD=staging-redis-password
REDIS_DB=0
REDIS_KEY_PREFIX=ris:staging:

# Redis connection pool
REDIS_MAX_RETRIES=3
REDIS_RETRY_DELAY_MS=100

# ================================================================
# CACHING CONFIGURATION
# ================================================================

# Production-like TTL but shorter for testing
CACHE_TTL_WORK_ITEMS=180
CACHE_TTL_WORK_ITEM_DETAILS=600
CACHE_TTL_ITERATIONS=1200
CACHE_TTL_TEAM_CAPACITY=600
CACHE_TTL_METRICS=180
CACHE_TTL_TEAM_MEMBERS=1200

# Enable caching
ENABLE_CACHING=true
CACHE_INVALIDATION_STRATEGY=incremental

# ================================================================
# REAL-TIME FEATURES
# ================================================================

# WebSocket configuration (production-like)
ENABLE_WEBSOCKETS=true
WEBSOCKET_PORT=3003
MAX_WEBSOCKET_CLIENTS=100

# Real-time polling
REALTIME_POLLING_INTERVAL=20000
ENABLE_INCREMENTAL_UPDATES=true
ENABLE_CHANGE_DETECTION=true

# ================================================================
# LOGGING CONFIGURATION
# ================================================================

# Detailed logging for staging
LOG_LEVEL=info
LOG_FILE_PATH=/var/log/ris-dashboard-staging/app.log
LOG_MAX_FILES=5
LOG_MAX_SIZE=50m

# Structured logging for staging
ENABLE_STRUCTURED_LOGGING=true
LOG_FORMAT=json

# ================================================================
# DATABASE CONFIGURATION
# ================================================================

# Staging Supabase
NEXT_PUBLIC_SUPABASE_URL=https://staging-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=staging-supabase-anon-key
SUPABASE_SERVICE_ROLE_KEY=staging-supabase-service-role-key

# Database connection pool (production-like)
DB_POOL_MIN=2
DB_POOL_MAX=10
DB_CONNECTION_TIMEOUT=20000

# ================================================================
# SECURITY CONFIGURATION
# ================================================================

# Production-like rate limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=500
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=true

# CORS settings
CORS_CREDENTIALS=true
CORS_MAX_AGE=43200

# Security headers enabled
ENABLE_SECURITY_HEADERS=true
CONTENT_SECURITY_POLICY=default-src 'self' *.your-domain.com

# ================================================================
# MONITORING AND METRICS
# ================================================================

# Health check configuration
HEALTH_CHECK_INTERVAL=30000
HEALTH_CHECK_TIMEOUT=5000

# Performance monitoring
ENABLE_PERFORMANCE_MONITORING=true
PERFORMANCE_SAMPLE_RATE=0.5

# Metrics collection
ENABLE_METRICS_COLLECTION=true
METRICS_ENDPOINT=/metrics
METRICS_RETENTION_DAYS=14

# ================================================================
# EMAIL CONFIGURATION
# ================================================================

# Staging SMTP (use real service but staging settings)
SMTP_HOST=staging-smtp-host.com
SMTP_PORT=587
SMTP_SECURE=true
SMTP_USER=staging-smtp-username
SMTP_PASS=staging-smtp-password

# Email settings
EMAIL_FROM=staging@your-domain.com
EMAIL_NOTIFICATIONS_ENABLED=true

# ================================================================
# BACKUP AND RECOVERY
# ================================================================

# Backup configuration (reduced retention)
ENABLE_AUTOMATED_BACKUPS=true
BACKUP_SCHEDULE=0 3 * * *
BACKUP_RETENTION_DAYS=14
BACKUP_STORAGE_PATH=/var/backups/ris-dashboard-staging

# ================================================================
# FEATURE FLAGS
# ================================================================

# Test all features in staging
ENABLE_ADVANCED_ANALYTICS=true
ENABLE_EXPORT_FEATURES=true
ENABLE_BULK_OPERATIONS=true
ENABLE_AUDIT_LOGGING=true

# Test experimental features
ENABLE_EXPERIMENTAL_FEATURES=true
EXPERIMENTAL_CACHE_STRATEGY=true

# ================================================================
# INTEGRATION CONFIGURATION
# ================================================================

# Staging integrations (test channels)
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/staging/webhook
TEAMS_WEBHOOK_URL=https://staging.webhook.office.com/webhookb2/staging

# Staging API keys
EXTERNAL_API_KEY=staging-external-api-key
EXTERNAL_API_TIMEOUT=8000

# ================================================================
# DEPLOYMENT CONFIGURATION
# ================================================================

# Staging container configuration
CONTAINER_MEMORY_LIMIT=768M
CONTAINER_CPU_LIMIT=0.75

# Load balancer
ENABLE_LOAD_BALANCER_HEALTH_CHECK=true
HEALTH_CHECK_PATH=/health

# Graceful shutdown
GRACEFUL_SHUTDOWN_TIMEOUT=20000

# ================================================================
# STAGING-SPECIFIC FEATURES
# ================================================================

# Debug settings (some enabled for staging testing)
ENABLE_DEBUG_LOGGING=false
ENABLE_REQUEST_LOGGING=true
ENABLE_DETAILED_ERRORS=true

# Some development tools for staging validation
ENABLE_DEV_MIDDLEWARE=false
ENABLE_CORS_DEBUG=false

# Performance testing
ENABLE_LOAD_TESTING=true
ENABLE_STRESS_TESTING=true

# Data validation
ENABLE_DATA_VALIDATION=true
ENABLE_SCHEMA_VALIDATION=true

# ================================================================
# TESTING CONFIGURATION
# ================================================================

# End-to-end testing
ENABLE_E2E_TESTING=true
E2E_TEST_TIMEOUT=30000

# API testing
ENABLE_API_TESTING=true
API_TEST_COVERAGE_THRESHOLD=80

# Integration testing
ENABLE_INTEGRATION_TESTING=true
INTEGRATION_TEST_PARALLEL=true